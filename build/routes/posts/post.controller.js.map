{"version":3,"sources":["..\\..\\..\\server\\routes\\posts\\post.controller.js"],"names":[],"mappings":"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","file":"server/routes/posts/post.controller.js","sourcesContent":["import Post from './post.model';\r\nimport Category from '../categories/category.model';\r\n\r\nconst index = (req, res, next)=> {\r\n\r\n    Post.find({})\r\n        .populate('category')\r\n        .exec((error, posts)=>{\r\n        if(error){\r\n            return next(error);\r\n        }\r\n        if(!posts){\r\n            return next(error);\r\n        }\r\n        res.json(posts);\r\n    })\r\n}\r\n\r\nconst showBriefs = (req, res, next) => {\r\n    Post.find({})\r\n        .limit( 5 )\r\n        .sort( { createdAt: -1})\r\n        .select({ content: 0, keywords: 0})\r\n        .populate('category')\r\n        .exec((error, posts)=>{\r\n            if(error){\r\n                return next(error);\r\n            }\r\n            if(!posts){\r\n                return next(error);\r\n            }\r\n            res.json(posts);\r\n        });\r\n}\r\n\r\nconst update = (req, res, next)=>{\r\n    let id = req.params.postId;\r\n\r\n    Post.findById(id)\r\n        .populate('category')\r\n        .exec((error, post)=>{\r\n            if(error) return next(error);\r\n            if(!post) return next(error);\r\n\r\n            post.update(req.body, { runValidators: true, context: 'query' }, (error, pos)=> {\r\n                if(error) return next(error);\r\n                res.json(pos);\r\n            });\r\n        });\r\n}\r\n\r\nconst create = (req, res, next)=>{\r\n    let newPost = new Post(req.body);\r\n\r\n    newPost.save((error, post)=>{\r\n        if(error) return next(error);\r\n\r\n        res.status(201).json(post);\r\n    });\r\n}\r\n\r\nconst remove = (req, res, next)=>{\r\n    let id = req.params.postId;\r\n\r\n    Post.findById(id)\r\n        .exec((error, post)=>{\r\n            if(error) return next(error);\r\n            if(!post) return next(error);\r\n\r\n            post.remove((error)=>{\r\n                if(error) return next(error);\r\n\r\n                res.status(204).end();\r\n            });\r\n        });\r\n}\r\n\r\nconst getOne = (req, res, next)=>{\r\n    let id = req.params.postId;\r\n    Post.findOne({ slug: id})\r\n        .populate('category')\r\n        .exec((error, post)=>{\r\n            if(error) return next(error);\r\n            if(!post) return next(error);\r\n\r\n            res.json(post);\r\n        });\r\n    /*if( id.length > 24){\r\n        // for slug\r\n        Post.findOne({ slug: id})\r\n            .populate('category')\r\n            .exec((error, post)=>{\r\n                if(error) return next(error);\r\n                if(!post) return next(error);\r\n\r\n                res.json(post);\r\n            });\r\n    }\r\n    Post.findById(id)\r\n        .populate('category')\r\n        .exec((error, post)=>{\r\n            if(error) return next(error);\r\n            if(!post) return next(error);\r\n\r\n            res.json(post);\r\n        });\r\n        */\r\n}\r\n\r\nconst getCategoryPost = (req, res, next)=>{\r\n    const slug = req.params.categorySlug;\r\n    Category.findOne({url: slug}).exec((error,category)=>{\r\n        if(error){\r\n            return next(error);\r\n        }\r\n        if(category === null){\r\n            res.status(404).json({\r\n                msg: '404'\r\n            });\r\n        }else {\r\n            Post.find({category: category._id})\r\n                .populate('category')\r\n                .exec((error, posts)=>{\r\n                    if(error){\r\n                        return next(error);\r\n                    }\r\n                    if(!posts){\r\n                        return next(error);\r\n                    }\r\n                    res.json(posts);\r\n                })\r\n        }\r\n\r\n    });\r\n\r\n\r\n}\r\n\r\nexport { index, showBriefs, update, create, remove, getOne, getCategoryPost } ;"]}