{"version":3,"sources":["..\\..\\..\\server\\routes\\posts\\post.model.js"],"names":[],"mappings":";;;;wBAAiC,UAAU;;IAApC,QAAQ;;IAAI,MAAM,aAAN,MAAM;;IAChB,IAAI,WAAQ,cAAc,EAA1B,IAAI;;AAEb,IAAI,UAAU,GAAG,IAAI,MAAM,CAAC;AACxB,aAAS,EAAE;AACP,YAAI,EAAE,IAAI;AACV,mBAAS,IAAI,CAAC,GAAG;KACpB;AACD,SAAK,EAAE;AACH,YAAI,EAAE,MAAM;AACZ,gBAAQ,EAAE,IAAI;KACjB;AACD,WAAO,EAAE;AACL,YAAI,EAAE,MAAM;AACZ,gBAAQ,EAAE,IAAI;KACjB;AACD,WAAO,EAAE;AACL,YAAI,EAAE,MAAM;AACZ,gBAAQ,EAAE,IAAI;KACjB;AACD,kBAAc,EAAE;AACZ,YAAI,EAAE,MAAM;AACZ,eAAO,EAAE,IAAI;KAChB;AACD,QAAI,EAAE;AACF,YAAI,EAAE,MAAM;AACZ,cAAM,EAAE,IAAI;KACf;AACD,YAAQ,EAAE;AACN,YAAI,EAAE,MAAM,CAAC,KAAK,CAAC,QAAQ;AAC3B,WAAG,EAAE,UAAU;KAClB;AACD,YAAQ,EAAE;AACN,YAAI,EAAE,KAAK;AACX,cAAM,EAAE,IAAI;KACf;AACD,WAAO,EAAE;AACL,YAAI,EAAE,OAAO;AACb,mBAAS,KAAK;KACjB;CACJ,CAAC,CAAC;;AAEH,UAAU,CAAC,GAAG,CAAC,MAAM,EAAE,UAAU,IAAI,EAAE;AACnC,QAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;;AAEvB,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAE,IAAI,GAAE,GAAG,CAAC,OAAO,EAAE,CAAC;;AAEjE,QAAG,IAAI,CAAC,cAAc,KAAK,SAAS,IAAI,IAAI,CAAC,cAAc,KAAK,IAAI,EAAC;;AAEjE,YAAM,UAAU,GAAG,qCAAqC,CAAC;;AAEzD,YAAI,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;AAE5C,YAAG,OAAO,EAAC;AACP,gBAAI,CAAC,cAAc,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;SACpC,MAAK;AACF,gBAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC;SAC3C;KACJ;AACD,QAAI,EAAE,CAAC;CACV,CAAC,CAAC;;iBAEY,QAAQ,CAAC,KAAK,CAAC,MAAM,EAAE,UAAU,CAAC","file":"server/routes/posts/post.model.js","sourcesContent":["import mongoose, { Schema } from 'mongoose';\r\nimport { meta } from '../../config';\r\n\r\nlet PostSchema = new Schema({\r\n    createdAt: {\r\n        type: Date,\r\n        default: Date.now\r\n    },\r\n    title: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    excerpt: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    content: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    thumbnailImage: {\r\n        type: String,\r\n        require: true\r\n    },\r\n    slug: {\r\n        type: String,\r\n        unique: true\r\n    },\r\n    category: {\r\n        type: Schema.Types.ObjectId,\r\n        ref: \"Category\"\r\n    },\r\n    keywords: {\r\n        type: Array,\r\n        option: true\r\n    },\r\n    publish: {\r\n        type: Boolean,\r\n        default: false\r\n    }\r\n});\r\n\r\nPostSchema.pre('save', function (next) {\r\n    const now = new Date();\r\n\r\n    this.slug = this.title.split(' ').join('-') +\"--\"+ now.valueOf();\r\n\r\n    if(this.thumbnailImage === undefined || this.thumbnailImage === null){\r\n\r\n        const regexImage = /<img[^>]+src=\"?([^\"\\s]+)\"?[^>]*\\/>/g;\r\n\r\n        let results = regexImage.exec(this.content);\r\n\r\n        if(results){\r\n            this.thumbnailImage = results[0];\r\n        }else {\r\n            this.thumbnailImage = meta.defaultImage;\r\n        }\r\n    }\r\n    next();\r\n});\r\n\r\nexport default mongoose.model('Post', PostSchema);\r\n"]}